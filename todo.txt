(A) 1 Create v2/lib/DC4U/TUI.pm main controller module using Curses that manages screen layout with header bar, main content area, and status bar, and dispatches to sub-screens (FileBrowser, FormatSelector, Progress, Preview, ErrorDisplay) +feature +tui
(A) 2 Implement TUI::FileBrowser screen in v2/lib/DC4U/TUI/FileBrowser.pm that scans cwd for .dc files, renders scrollable list with arrow-key nav and enter-to-select, shows file size and charge count preview +feature +tui
(A) 3 Implement TUI::FormatSelector screen in v2/lib/DC4U/TUI/FormatSelector.pm rendering PDF/HTML/TXT/MD/RMD/DOCX as radio-button list with one-line description per format, returns selected format string +feature +tui
(A) 4 Implement TUI::JurisdictionSelector screen in v2/lib/DC4U/TUI/JurisdictionSelector.pm showing available jurisdictions (singapore, uk) with config preview panel, returns jurisdiction string +feature +tui
(A) 5 Implement TUI::Progress screen in v2/lib/DC4U/TUI/Progress.pm showing step-by-step pipeline (Lexing→Parsing→Generating) with spinner animation, elapsed time, and per-charge-block progress bar +feature +tui
(A) 6 Implement TUI::Preview screen in v2/lib/DC4U/TUI/Preview.pm that renders the generated charge output as formatted terminal text (HTML tags stripped, fields highlighted with ANSI colors) before write-to-disk confirmation +feature +tui
(A) 7 Implement TUI::ErrorDisplay screen in v2/lib/DC4U/TUI/ErrorDisplay.pm that renders parse/generation errors with source line context, caret pointing to error column, and suggested fix text +feature +tui
(A) 8 Implement TUI::ChargeNavigator in v2/lib/DC4U/TUI/ChargeNav.pm for multi-charge .dc files showing charge index sidebar, per-charge format override, and tab between charges +feature +tui
(A) 9 Wire TUI into bin/dc4u as default mode when invoked with no --format flag: launch TUI->run() flow (select file → jurisdiction → format → process → preview → confirm write), preserve all existing CLI flags for non-interactive use +feature +tui
(B) 10 Fix v2 Parser.pm loop: replace `for my $i (0 .. $#$tokens)` with `my $i = 0; while ($i <= $#$tokens) { ... $i++; }` so that inner `$i++` and `$i = $j` correctly skip tokens during OUTPUT_FORMAT, STATUTE_INFO, and COMMENT parsing +bugfix
(B) 11 Fix v2 bin/dc4u fileparse: remove custom sub, add `use File::Basename`, call `fileparse($input_file, qr/\.[^.]*$/)` which returns ($name, $path, $suffix) in correct order for batch output naming +bugfix
(B) 12 Fix v2 bin/dc4u multi-charge output: iterate all entries in $results arrayref writing each to separate files named {base}-charge-{n}.{ext} or concatenate for text-based formats (HTML/TXT/MD) with separator +bugfix
(B) 13 Fix v2 Generator _generate_pdf: remove silent HTML fallback, die with message "PDF::API2 required for PDF output. Install via: cpan PDF::API2" when module is missing +bugfix
(B) 14 Implement real multi-line PDF layout in v2 Generator _generate_pdf using PDF::API2 with word-wrap, page breaks, configurable font_family/font_size/margins read from Config->get('formats.pdf.*') +feature
(B) 15 Implement real DOCX generation in v2 Generator _generate_docx using minimal Office Open XML: create word/document.xml with charge content, [Content_Types].xml, _rels/.rels, and zip into .docx using Archive::Zip +feature
(B) 16 Integrate Template module into Generator: replace _build_charge_content() with Template->render($jurisdiction . '_charge', $parsed_data, $format) using Config->get('jurisdiction') to select template set +refactor
(B) 17 Wire Config format settings into Generator: pass $config to each _generate_* sub, read font_family/font_size/margins for PDF, css_file path for HTML, line_width for TXT from $config->get() calls +refactor
(B) 18 Fix HTML output to reference charge.css: in Generator _generate_html, replace inline <style> block with <link rel="stylesheet" href="charge.css"> or embed file contents of templates/css/charge.css via Config->get('formats.html.css_file') +bugfix
(B) 19 Fix Parser _parse_date to accept both DD/MM/YYYY numeric format and written formats like "19 August 2019" or "19/8/2019" by adding regex branch for month-name dates and normalizing all to "D Month YYYY" output +bugfix
(B) 20 Add UK jurisdiction support to Parser: when Config jurisdiction is 'uk', use alternate required_fields (name, dob, address instead of nric/race/age/gender/nationality), add _parse_suspect_info_uk method +feature
(B) 21 Add UK charge and officer parsing in Parser with UK-specific field expectations (charge_location field, prosecutor vs charging officer terminology) keyed off Config jurisdiction +feature
(B) 22 Wire UK templates in Template.pm into Generator render path: when jurisdiction is 'uk', Template->render('uk_charge', ...) populates UK-specific placeholders (suspect_dob, suspect_address, charge_location) +feature
(B) 23 Add --jurisdiction|-j flag to bin/dc4u CLI that sets config jurisdiction before processing, validate against known jurisdictions (singapore, uk), default to config file value +feature
(B) 24 Fix v2/t/test_dc4u.t: change test plan to match actual assertion count, pass {output_format => 'PDF'} options hash to parser->parse() call, add tests for multi-charge split, written date parsing, and UK jurisdiction parsing +infra
(B) 25 Add v2/t/test_integration.t that processes samples/v2/test_simple.dc through full DC4U::process_dc_file pipeline for each format (HTML/TXT/MD) and asserts output contains suspect name, statute, and officer date +infra
(B) 26 Create Makefile.PL in v2/ with ExtUtils::MakeMaker declaring NAME=DC4U, VERSION_FROM=lib/DC4U.pm, EXE_FILES=[bin/dc4u], PREREQ_PM={PDF::API2, YAML::Tiny, Archive::Zip, Curses}, for cpan/cpanm install support +infra
(B) 27 Create Homebrew formula at Formula/dc4u.rb that depends on perl, installs via Makefile.PL, copies config/dc4u.yaml to etc/dc4u/, copies templates/ to share/dc4u/templates/ +infra
(B) 28 Add GitHub Actions CI workflow at .github/workflows/ci.yml running `perl -Ilib -c` syntax checks and `prove -Ilib t/` on ubuntu-latest and macos-latest with cpanm for deps +infra
(B) 29 Add MIT LICENSE file to repository root with year and "DC4U Development Team" matching the license text declared in all module POD =head1 LICENSE sections +infra
(B) 30 Update root Makefile with targets: make tui (launch interactive TUI), make brew-install (local tap + brew install), make ci-local (run full test suite matching CI), make lint (perl -cw on all .pm files) +infra
